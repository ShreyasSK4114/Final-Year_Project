<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Smart Bros</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        /* RETRO SCROLLBAR */
        ::-webkit-scrollbar { width: 12px; background: #000; }
        ::-webkit-scrollbar-thumb { background: #e70012; border: 2px solid #000; }
        
        body { 
            font-family: 'Press Start 2P', cursive; 
            background-color: #202028;
            background-image: 
                linear-gradient(#111 50%, transparent 50%),
                linear-gradient(90deg, rgba(255,0,0,.06), rgba(0,255,0,.02), rgba(0,0,255,.06));
            background-size: 100% 4px, 6px 100%;
            min-height: 100vh; 
            padding: 20px;
            color: #fff;
            line-height: 1.6;
            font-size: 12px;
        }
        
        .chat-container { 
            max-width: 900px; 
            margin: 0 auto; 
            background: #000000; 
            border: 4px solid #000000;
            box-shadow: 10px 10px 0px rgba(0,0,0,0);
            position: relative;
            overflow: hidden; 
        }

        /* --- HEADER IS NOW THE GAME BACKGROUND --- */
        .chat-header { 
            background: #e70012; /* Mario Red */
            color: rgba(5, 5, 5, 0.973); 
            padding: 25px; 
            text-align: center; 
            border-bottom: 4px solid #fff;
            position: relative;
            height: 150px; /* Fixed height for game area */
            overflow: hidden; 
            cursor: pointer; /* Indicates clickable */
            user-select: none;
        }
        
        /* TEXT LAYERING */
        .header-content {
            position: relative;
            z-index: 10; 
            pointer-events: none; /* Let clicks pass through to header */
        }

        .chat-header h1 { 
            font-size: 16px; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px;
            text-shadow: 3px 3px 0 #000; 
            color: #fff;
        }
        
        .chat-header p { 
            font-size: 12px; 
            color: #ffff00; 
            text-shadow: 4px 4px 0 #000000; 
            letter-spacing: 1px; 
            margin-top: 5px; 
            line-height: 1.5;
            display: inline-block;
            white-space: nowrap; 
            animation: scrollLeftToRightText 8s linear infinite; 
            position: absolute; 
            left: 0;
            top: 60px; 
            transform: translateX(-100%); 
        }

        /* --- GAME OVER MESSAGE --- */
        #game-over-msg {
            display: none; /* Hidden by default */
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.85);
            color: #fff;
            padding: 20px;
            border: 4px solid #fff;
            z-index: 50;
            text-align: center;
        }

        /* --- FULL WIDTH GAME ELEMENTS --- */
        
        .game-floor {
            position: absolute;
            bottom: 10px;
            left: 0;
            width: 100%;
            height: 4px;
            background: #fff;
            z-index: 1;
        }

        /* --- CSS CODED DINOSAUR --- */
        #dino {
            width: 44px;
            height: 47px;
            background-color: #fff; /* White Dino */
            position: absolute;
            bottom: 14px; 
            left: 50px;   
            z-index: 2;
            
            /* CSS Shape for Dino Standing */
            clip-path: polygon(
                40% 0%, 60% 0%, 60% 10%, 100% 10%, 100% 40%, 60% 40%, 60% 50%, 
                80% 50%, 80% 60%, 20% 60%, 20% 30%, 0% 30%, 0% 50%, 20% 50%, 
                20% 80%, 0% 80%, 0% 100%, 25% 100%, 25% 70%, 50% 70%, 50% 100%, 
                75% 100%, 75% 80%, 40% 80%
            );
            transition: height 0.1s;
        }

        /* DUCK STATE (Squished) */
        #dino.ducking {
            height: 30px; /* Shorter */
            width: 55px;  /* Longer */
            /* CSS Shape for Dino Ducking */
            clip-path: polygon(
                50% 20%, 100% 20%, 100% 50%, 60% 50%, 60% 60%, 
                80% 60%, 80% 70%, 20% 70%, 20% 40%, 0% 40%, 0% 60%, 20% 60%, 
                20% 80%, 0% 80%, 0% 100%, 30% 100%, 30% 80%, 50% 80%, 50% 100%, 
                80% 100%, 80% 80%, 50% 80%
            );
        }

        /* JUMP ANIMATION */
        .animate-jump {
            animation: jump 0.6s ease-out;
        }

        @keyframes jump {
            0% { bottom: 14px; }
            40% { bottom: 90px; } 
            60% { bottom: 90px; }
            100% { bottom: 14px; }
        }

        /* THE CACTUS */
        #cactus {
            width: 25px;
            height: 35px;
            background-color: #000; 
            position: absolute;
            bottom: 14px;
            right: -30px; 
            z-index: 2;
            animation: cactusMove 2s infinite linear;
            clip-path: polygon(20% 0%, 80% 0%, 80% 100%, 20% 100%, 20% 60%, 0% 60%, 0% 30%, 20% 30%, 80% 30%, 100% 30%, 100% 60%, 80% 60%);
        }

        @keyframes cactusMove {
            0% { right: -30px; }
            100% { right: 100%; } 
        }

        @keyframes scrollLeftToRightText {
            0% { transform: translateX(-100%); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateX(900px); opacity: 0; }
        }

        .coin {
            width: 24px; height: 32px;
            background-image: url('https://raw.githubusercontent.com/jmflhs/Mario-Bros-Assets/master/assets/coin_1.png');
            background-size: contain; background-repeat: no-repeat;
            position: absolute; top: 25px; right: 25px;
            image-rendering: pixelated;
            z-index: 15; 
        }

        .chat-messages { 
            height: 500px; 
            overflow-y: auto; 
            padding: 25px; 
            background: #101317; 
            position: relative;
            z-index: 5; 
        }
        
        .moving-cloud {
            position: absolute; top: 50px; left: -150px; width: 200px; height: 100px;
            background: radial-gradient(circle, rgba(255,255,255,0.4) 20%, transparent 20%);
            background-size: 60px 60px; z-index: 4; pointer-events: none;
            animation: cloudMove 25s linear infinite; opacity: 0.7;
        }
        @keyframes cloudMove { 0% { left: -20%; } 100% { left: 100%; } }

        .bg-lakitu {
            position: absolute; top: 120px; left: -50px; width: 48px; z-index: 6; 
            opacity: 0.8; pointer-events: none; animation: floatAcross 15s linear infinite;
        }
        @keyframes floatAcross { 0% { left: -10%; transform: translateY(0px); } 50% { transform: translateY(-20px); } 100% { left: 110%; transform: translateY(0px); } }

        .message { margin-bottom: 30px; display: flex; align-items: flex-end; position: relative; z-index: 7; }
        .user-message { flex-direction: row-reverse; }
        .bot-message { flex-direction: row; }

        .character-sprite {
            width: 48px; height: 48px; margin: 0 12px; image-rendering: pixelated; 
            filter: drop-shadow(4px 4px 0px rgba(0,0,0,0.5));
        }
        .user-message .character-sprite { animation: runInRight 0.5s ease-out, bounce 2s infinite ease-in-out 0.5s; }
        .bot-message .character-sprite { animation: runInLeft 0.5s ease-out, bounce 2s infinite ease-in-out 0.5s; }
        @keyframes runInRight { 0% { transform: translateX(100px); opacity: 0; } 100% { transform: translateX(0); opacity: 1; } }
        @keyframes runInLeft { 0% { transform: translateX(-100px); opacity: 0; } 100% { transform: translateX(0); opacity: 1; } }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
        
        .message-bubble { 
            max-width: 70%; padding: 15px; position: relative; font-size: 10px;
            box-shadow: -4px 0 0 0 black, 4px 0 0 0 black, 0 -4px 0 0 black, 0 4px 0 0 black;
            margin-bottom: 5px;
        }
        .user-bubble { background: #e70012; color: #fff; border: 4px solid #ffcccc; margin-right: 5px; }
        .bot-bubble { background: #000; color: #fff; border: 4px solid #00aa00; margin-left: 5px; }

        .system-header { color: #00ff00; text-align: center; margin-bottom: 10px; }
        .mission-list { color: #ffffff; line-height: 1.8; }
        .sensor-info { background: #000; border: 2px solid #ffff00; padding: 10px; margin: 10px 0; color: #ffff00; }
        
        .chat-input { padding: 20px; background: #222; border-top: 4px solid #fff; position: relative; z-index: 20; }
        .input-group { display: flex; gap: 15px; }
        #userInput { flex: 1; padding: 15px; background: #000; color: #fff; border: 4px solid #fff; outline: none; font-family: 'Press Start 2P', cursive; font-size: 10px; text-transform: uppercase; }
        #userInput:focus { border-color: #00aa00; }
        #sendButton { padding: 15px 25px; background: #00aa00; color: white; border: 4px solid #fff; cursor: pointer; font-family: 'Press Start 2P', cursive; font-size: 10px; text-transform: uppercase; box-shadow: 4px 4px 0px #000; }
        #sendButton:active { transform: translate(2px, 2px); box-shadow: 2px 2px 0px #000; }
        strong { color: #fff; text-shadow: 2px 2px 0 #000; }
    </style>
</head>
<body>
    <div class="chat-container">
        
        
        <!-- HEADER IS NOW CLICKABLE GAME AREA -->
        <div class="chat-header" onclick="handleHeaderClick()">
            
            <div class="coin"></div>
            
            <div class="header-content">
                <h1>SUPER SMART BROS.</h1>
                <p>INSERT COIN (Just kidding, type below)</p>
            </div>


            <!-- GAME ELEMENTS -->
            <div id="dino"></div>
            <div id="cactus"></div>
            <div class="game-floor"></div>
            
            <!-- GAME OVER MESSAGE -->
            <div id="game-over-msg">
                GAME OVER<br><br>
                <span style="font-size:10px; color:#ffff00; animation: blink 1s infinite;">CLICK TO RESTART</span>
            </div>

        </div>
        
        <div class="chat-messages" id="chatMessages">
            <div class="message bot-message">
                <img src="https://raw.githubusercontent.com/jmflhs/Mario-Bros-Assets/master/assets/mushroom-red.png" class="character-sprite" alt="Bot">
                <div class="message-bubble bot-bubble">
                    <div class="system-header">★ SYSTEM READY ★</div>
                    <strong>MISSION:</strong>
                    <br><br>
                    <div class="mission-list">
                        1. INPUT ACTIVITY<br>
                        2. SCAN SENSORS<br>
                        3. OPTIMIZE ROOM
                    </div>
                    <br>
                    <div class="sensor-info">SENSORS: ONLINE [OK]</div>
                </div>
            </div>

            <div class="message user-message">
                <img src="https://raw.githubusercontent.com/jmflhs/Mario-Bros-Assets/master/assets/mario-stand.png" class="character-sprite" alt="Mario">
                <div class="message-bubble user-bubble">
                    I need to focus on coding late at night!
                </div>
            </div>
        </div>
        
        <div class="chat-input">
            <div class="input-group">
                <input type="text" id="userInput" placeholder="WHAT ARE WE DOING?" autocomplete="off">
                <button id="sendButton">START</button>
            </div>
        </div>
    </div>

    <script>
        // --- GAME LOGIC ---
        const dino = document.getElementById("dino");
        const cactus = document.getElementById("cactus");
        const gameOverMsg = document.getElementById("game-over-msg");
        let isGameOver = false;

        function jump() {
            if (isGameOver) return;
            // Cannot jump if ducking
            if (dino.classList.contains("ducking")) return;

            if (dino.classList != "animate-jump") {
                dino.classList.add("animate-jump");
                setTimeout(function() {
                    dino.classList.remove("animate-jump");
                }, 600);
            }
        }

        function duck(isDucking) {
            if (isGameOver) return;
            // Cannot duck if jumping
            if (dino.classList.contains("animate-jump")) return;

            if (isDucking) {
                dino.classList.add("ducking");
            } else {
                dino.classList.remove("ducking");
            }
        }
        
        // COLLISION DETECTION LOOP
        let checkDeadInterval = setInterval(function() {
            if (isGameOver) return;

            // Get current positions
            let dinoRect = dino.getBoundingClientRect();
            let cactusRect = cactus.getBoundingClientRect();

            // Check overlap
            // We use a small buffer (+10/-10) to make hitboxes forgiving
            if (
                dinoRect.right > cactusRect.left + 15 && 
                dinoRect.left < cactusRect.right - 15 && 
                dinoRect.bottom > cactusRect.top + 10
            ) {
                endGame();
            }
        }, 10);

        function endGame() {
            isGameOver = true;
            
            // Stop Animations
            cactus.style.animationPlayState = "paused";
            dino.style.animationPlayState = "paused";
            
            // Show Game Over Screen
            gameOverMsg.style.display = "block";
        }

        function resetGame() {
            isGameOver = false;
            
            // Hide Game Over Screen
            gameOverMsg.style.display = "none";
            
            // Reset Cactus Animation (trick to restart CSS animation)
            cactus.style.animation = 'none';
            cactus.offsetHeight; /* trigger reflow */
            cactus.style.animation = 'cactusMove 2s infinite linear';
            
            // Reset Dino
            dino.style.animationPlayState = "running";
            dino.classList.remove("animate-jump");
            dino.classList.remove("ducking");
        }

        function handleHeaderClick() {
            if (isGameOver) {
                resetGame();
            } else {
                jump();
            }
        }

        // KEYBOARD CONTROLS
        document.addEventListener('keydown', function(e) {
            // Prevent scrolling for game keys
            if(["Space", "ArrowUp", "ArrowDown"].indexOf(e.code) > -1) {
                e.preventDefault();
            }

            if ((e.key === "ArrowUp" || e.code === "Space")) {
                if (isGameOver) resetGame();
                else jump();
            }
            if (e.key === "ArrowDown") {
                duck(true);
            }
        });

        document.addEventListener('keyup', function(e) {
            if (e.key === "ArrowDown") {
                duck(false);
            }
        });

        // --- CHAT LOGIC ---
        const HERO_SPRITES = [
            "https://raw.githubusercontent.com/jmflhs/Mario-Bros-Assets/master/assets/mario-stand.png",
            "https://raw.githubusercontent.com/jmflhs/Mario-Bros-Assets/master/assets/luigi-stand.png",
            "https://raw.githubusercontent.com/jmflhs/Mario-Bros-Assets/master/assets/peach-stand.png"
        ];

        const BOT_SPRITES = [
            "https://raw.githubusercontent.com/jmflhs/Mario-Bros-Assets/master/assets/mushroom-red.png",
            "https://raw.githubusercontent.com/jmflhs/Mario-Bros-Assets/master/assets/goomba.png", 
            "https://raw.githubusercontent.com/jmflhs/Mario-Bros-Assets/master/assets/star.png"
        ];

        function addMessage(text, isUser) {
            const container = document.getElementById('chatMessages');
            const msgDiv = document.createElement('div');
            msgDiv.className = isUser ? 'message user-message' : 'message bot-message';
            
            const spriteList = isUser ? HERO_SPRITES : BOT_SPRITES;
            const randomSprite = spriteList[Math.floor(Math.random() * spriteList.length)];
            
            const img = document.createElement('img');
            img.src = randomSprite;
            img.className = 'character-sprite';
            
            const bubble = document.createElement('div');
            bubble.className = isUser ? 'message-bubble user-bubble' : 'message-bubble bot-bubble';
            bubble.innerHTML = text;
            
            msgDiv.appendChild(img);
            msgDiv.appendChild(bubble);
            
            container.appendChild(msgDiv);
            container.scrollTop = container.scrollHeight;
        }

        document.getElementById('sendButton').addEventListener('click', function() {
            const input = document.getElementById('userInput');
            const val = input.value.trim();
            if(val) {
                addMessage(val, true);
                input.value = '';
                setTimeout(() => {
                    addMessage("⏳ <strong>PROCESSING...</strong><br>Scanning room data...", false);
                }, 1000);
            }
        });
        
        document.getElementById('userInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') document.getElementById('sendButton').click();
        });
    </script>
</body>
</html>